<div ng-controller="Umbraco.PropertyEditors.GridPrevalueEditor.RowConfigController as vm">
    <umb-editor-view>
        <form novalidate name="RowConfigurationForm" val-form-manager>

            <umb-editor-header
                name="model.title"
                name-locked="true"
                hide-alias="true"
                hide-icon="true"
                hide-description="true">
            </umb-editor-header>

            <umb-editor-container>
                <umb-box>
                    <umb-box-content>
                        <div class="umb-form-settings form-horizontal">

                            <p><localize key="grid_addRowConfigurationDetail" /></p>

                            <div class="alert alert-warn ng-scope" ng-show="nameChanged">
                                <p>Modifying a row configuration name will result in loss of
                                data for any existing content that is based on this configuration.</p>
                                <p><strong>Modifying only the label will not result in data loss.</strong></p>
                            </div>

                            <umb-control-group label="@general_name">
                                <input type="text" ng-model="currentRow.name" />
                            </umb-control-group>

                            <umb-control-group label="@general_label">
                                <input type="text" ng-model="currentRow.label" placeholder="Overrides name" />
                            </umb-control-group>

                            <div class="umb-grid-preview--rows umb-grid-preview--rows__wide">
                                <div class="umb-grid-preview--row">
                                    <button type="button" class="btn-reset umb-grid-preview--col umb-grid-preview--col__deep -has-hover"
                                        ng-class="{selected:cell==currentCell}"
                                        ng-repeat="cell in currentRow.areas"
                                        ng-click="configureCell(cell, currentRow)"
                                        ng-style="{width: percentage(cell.grid) + '%'}">
                                        <span class="sr-only">
                                            <localize key="grid_editRowConfiguration">Edit row configuration</localize>
                                        </span>
                                    </button>

                                    <button type="button" class="btn-reset umb-grid-preview--col__add" ng-if="availableRowSpace > 0"                                    
                                    ng-click="configureCell(null, currentRow)"
                                    ng-style="{width: percentage(availableRowSpace) + '%'}">
                                        <umb-icon icon="icon-add"></umb-icon>
                                        <span class="sr-only">
                                            <localize key="grid_addRowConfiguration">Add row configuration</localize>
                                        </span>
                                    </button>
                                </div>
                            </div>

                            <div ng-if="currentCell != null" class="mt2">
                                <umb-control-group label="@general_width">
                                    <div class="grid-size-scaler">
                                        <button type="button" class="btn-link" ng-click="scaleDown(currentCell)" aria-label="Scale down">
                                            <umb-icon icon="icon-remove"></umb-icon>
                                        </button>
                                        <span>{{currentCell.grid}}</span>
                                        <button type="button" class="btn-link" ng-click="scaleUp(currentCell, availableRowSpace, true)" aria-label="Scale up">
                                            <umb-icon icon="icon-add"></umb-icon>
                                        </button>
                                    </div>
                                </umb-control-group>

                                <umb-control-group label="@grid_maxItems" description="@grid_maxItemsDescription">
                                    <input type="number" ng-model="currentCell.maxItems" class="umb-property-editor-tiny" placeholder="Max" min="0" />
                                </umb-control-group>

                                <umb-control-group hide-label="true">  
                                    <button type="button" class="btn btn-danger"
                                            ng-click="deleteArea(currentCell, currentRow)">
                                        <localize key="general_delete">Delete</localize>
                                    </button>
                                </umb-control-group>    

                                <umb-control-group hide-label="true">
                                    <umb-toggle checked="currentCell.allowAll"
                                                on-click="toggleAllowed(currentCell)"
                                                show-labels="true"
                                                label-position="right"
                                                label-off="{{vm.labels.allowAllEditors}}"
                                                label-on="{{vm.labels.allowAllEditors}}">
                                    </umb-toggle>

                                    <div ng-if="currentCell.allowAll === false">
                                        <hr />
                                        <ul class="unstyled">
                                            <li ng-repeat="editor in editors track by $id(editor)">
                                                <umb-checkbox model="editor.allowed"
                                                            input-id="editorconfig-{{$index}}"
                                                            on-change="selectEditor(currentCell, editor)">
                                                    <umb-icon icon="{{editor.icon}}"></umb-icon> {{editor.name}}
                                                    <small class="input-label--small">({{editor.alias}})</small>
                                                </umb-checkbox>
                                            </li>
                                        </ul>
                                    </div>
                                </umb-control-group>
                            </div>
                        </div>
                    </umb-box-content>
                </umb-box>
            </umb-editor-container>

            <umb-editor-footer>
                <umb-editor-footer-content-right>
                    <umb-button
                        type="button"
                        button-style="link"
                        label-key="general_close"
                        shortcut="esc"
                        action="close()">
                    </umb-button>
                    <umb-button
                        type="button"
                        button-style="success"
                        label-key="general_submit"
                        action="submit()">
                    </umb-button>
                </umb-editor-footer-content-right>
            </umb-editor-footer>

        </form>
    </umb-editor-view>
</div>
